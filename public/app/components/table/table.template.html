<div ng-controller="tableCtrl">
  <table>
    <tr>
      <th
        ng-repeat="property in headings | relevant"
        ng-click="changeOrder(property)"
      >
        {{ (property | toLabel:sortBy:reverse) }}
      </th>
    </tr>
    <tr ng-repeat="item in data | toArray | orderBy:sortBy:reverse">
      <td
        ng-repeat="(key, value) in item | relevant"
        ng-dblclick="select(item.id, key)"
      >
        <input
          type="text"
          id="{{property+item.id}}"
          ng-if="selected && selected.id === item.id && selected.property === key"
          ng-model="data[item.id][key]"
          ng-model-options="{ updateOn: 'blur' }"
          ng-change="deselect($event)"
          ng-blur="deselect($event)"
          focus-on="propSelected"
        />
        <span
          ng-if="!selected || selected.id !== item.id || selected.property !== key"
          >{{data[item.id][key]}}</span
        >
      </td>
    </tr>
  </table>

  <button ng-click="save()">Save</button>
</div>
